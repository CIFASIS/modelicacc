CXXFLAGS = -I. -Wall -Werror -Wno-reorder -O3 

OBJS_COMMON :=  ast/expression.o \
		ast/class.o \
		ast/equation.o \
		ast/statement.o \
		ast/modification.o \
		ast/element.o \
		ast/expression.o \
		parser/ident.o \
		parser/expression.o \
		parser/modification.o \
		parser/equation.o \
		parser/statement.o \
		parser/class.o \
		parser/parser.o

all:lib/libmodelica.a bin/antialias bin/flatter bin/mmo bin/causalize doc

include antialias/Makefile.include
include mmo/Makefile.include
include flatter/Makefile.include
include causalize/Makefile.include

lib/libmodelica.a: $(OBJS_COMMON)
	$(AR) rcs lib/libmodelica.a $(OBJS_COMMON)

%.o: %.cpp %.h
	$(CXX) -c $(CXXFLAGS) $*.cpp -o $*.o

doc: Doxyfile
	doxygen

clean:
	$(RM) -rf $(OBJS_COMMON) $(OBJS_ANTIALIAS) $(OBJS_FLATTER) $(OBJS_MMO) $(OBJS_CAUSALIZE) $(OBJS_SPLITFOR) lib/libmodelica.a doc
